{"version":3,"file":"index.cjs.js","sources":["../../../packages/graphql-cli/common/dist/index.esm.js","../../../dist/graphql-cli/similar/src/index.js"],"sourcesContent":["import { loaders } from '@graphql-cli/loaders';\nexport { loaders } from '@graphql-cli/loaders';\n\nfunction parseGlobalArgs(args) {\n    const headers = {};\n    if (args.header) {\n        args.header.forEach((header) => {\n            const [name, ...values] = header.split(':');\n            headers[name] = values.join('');\n        });\n    }\n    if (args.require) {\n        args.require.forEach((mod) => require(mod));\n    }\n    return { headers, token: args.token };\n}\nconst createInspectorExtension = (name) => (api) => {\n    loaders.forEach((loader) => {\n        api.loaders.schema.register(loader);\n    });\n    loaders.forEach((loader) => {\n        api.loaders.documents.register(loader);\n    });\n    return {\n        name,\n    };\n};\n\nexport { createInspectorExtension, parseGlobalArgs };\n//# sourceMappingURL=index.esm.js.map\n","import { __awaiter } from \"tslib\";\nimport { defineCommand } from '@graphql-cli/common';\nimport { parseGlobalArgs, createInspectorExtension, loaders, } from '@graphql-inspector/graphql-cli-common';\nimport { handler } from '@graphql-inspector/similar-command';\nexport default defineCommand((api) => {\n    return {\n        command: 'similar [project]',\n        describe: 'Find similar types in a schema',\n        builder(yargs) {\n            return yargs\n                .positional('project', {\n                describe: 'Point to a project or schema',\n                type: 'string',\n            })\n                .options({\n                name: {\n                    alias: 'n',\n                    describe: 'Name of a type',\n                    type: 'string',\n                },\n                threshold: {\n                    alias: 't',\n                    describe: 'Threshold of similarity ratio',\n                    type: 'number',\n                },\n                write: {\n                    alias: 'w',\n                    describe: 'Write a file with stats',\n                    type: 'string',\n                },\n                require: {\n                    alias: 'r',\n                    describe: 'Require modules',\n                    type: 'array',\n                },\n                token: {\n                    alias: 't',\n                    describe: 'Access Token',\n                    type: 'string',\n                },\n                header: {\n                    alias: 'h',\n                    describe: 'Http Header',\n                    type: 'array',\n                },\n                config: {\n                    alias: 'c',\n                    type: 'string',\n                    describe: 'Location of GraphQL Config',\n                },\n            });\n        },\n        handler(args) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const writePath = args.write;\n                const type = args.name;\n                const threshold = args.threshold;\n                const { headers, token } = parseGlobalArgs(args);\n                const config = yield api.useConfig({\n                    rootDir: args.config || process.cwd(),\n                    extensions: [createInspectorExtension('similar')],\n                });\n                const project = config.projects[args.project || 'default'];\n                const { loadSchema } = api.useLoaders({ loaders });\n                const schema = yield (project.getSchema() ||\n                    loadSchema(args.project, {\n                        headers,\n                        token,\n                    }));\n                return handler({ schema, writePath, threshold, type });\n            });\n        },\n    };\n});\n//# sourceMappingURL=index.js.map"],"names":["loaders","defineCommand","__awaiter","handler"],"mappings":"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"}