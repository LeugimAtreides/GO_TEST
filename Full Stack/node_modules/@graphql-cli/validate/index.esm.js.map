{"version":3,"file":"index.esm.js","sources":["../../../packages/graphql-cli/common/dist/index.esm.js","../../../dist/graphql-cli/validate/src/index.js"],"sourcesContent":["import { loaders } from '@graphql-cli/loaders';\nexport { loaders } from '@graphql-cli/loaders';\n\nfunction parseGlobalArgs(args) {\n    const headers = {};\n    if (args.header) {\n        args.header.forEach((header) => {\n            const [name, ...values] = header.split(':');\n            headers[name] = values.join('');\n        });\n    }\n    if (args.require) {\n        args.require.forEach((mod) => require(mod));\n    }\n    return { headers, token: args.token };\n}\nconst createInspectorExtension = (name) => (api) => {\n    loaders.forEach((loader) => {\n        api.loaders.schema.register(loader);\n    });\n    loaders.forEach((loader) => {\n        api.loaders.documents.register(loader);\n    });\n    return {\n        name,\n    };\n};\n\nexport { createInspectorExtension, parseGlobalArgs };\n//# sourceMappingURL=index.esm.js.map\n","import { __awaiter } from \"tslib\";\nimport { defineCommand } from '@graphql-cli/common';\nimport { parseGlobalArgs, createInspectorExtension, loaders, } from '@graphql-inspector/graphql-cli-common';\nimport { handler } from '@graphql-inspector/validate-command';\nexport default defineCommand((api) => {\n    return {\n        command: 'validate [project]',\n        describe: 'Validate Fragments and Operations',\n        builder(yargs) {\n            return yargs\n                .positional('project', {\n                describe: 'Point to a project',\n                type: 'string',\n            })\n                .options({\n                schema: {\n                    describe: 'Point to a schema',\n                    type: 'string',\n                },\n                documents: {\n                    describe: 'Point to operations and fragments',\n                    type: 'string',\n                },\n                deprecated: {\n                    alias: 'd',\n                    describe: 'Fail on deprecated usage',\n                    type: 'boolean',\n                    default: false,\n                },\n                noStrictFragments: {\n                    describe: 'Do not fail on duplicated fragment names',\n                    type: 'boolean',\n                    default: false,\n                },\n                maxDepth: {\n                    describe: 'Fail on deep operations',\n                    type: 'number',\n                },\n                apollo: {\n                    describe: 'Support Apollo directives',\n                    type: 'boolean',\n                    default: false,\n                },\n                keepClientFields: {\n                    describe: 'Keeps the fields with @client, but removes @client directive from them',\n                    type: 'boolean',\n                    default: false,\n                },\n                require: {\n                    alias: 'r',\n                    describe: 'Require modules',\n                    type: 'array',\n                },\n                token: {\n                    alias: 't',\n                    describe: 'Access Token',\n                    type: 'string',\n                },\n                header: {\n                    alias: 'h',\n                    describe: 'Http Header',\n                    type: 'array',\n                },\n                config: {\n                    alias: 'c',\n                    type: 'string',\n                    describe: 'Location of GraphQL Config',\n                },\n            });\n        },\n        handler(args) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const apollo = args.apollo || false;\n                const maxDepth = args.maxDepth || undefined;\n                const strictFragments = !args.noStrictFragments;\n                const keepClientFields = args.keepClientFields || false;\n                const failOnDeprecated = args.deprecated;\n                const { headers, token } = parseGlobalArgs(args);\n                const config = yield api.useConfig({\n                    rootDir: args.config || process.cwd(),\n                    extensions: [createInspectorExtension('validate')],\n                });\n                if (args.documents && args.schema) {\n                    const { loadDocuments, loadSchema } = api.useLoaders({ loaders });\n                    const schema = yield loadSchema(args.schema, { headers, token });\n                    const documents = yield loadDocuments(args.documents, {\n                        headers,\n                        token,\n                    });\n                    return handler({\n                        schema,\n                        documents,\n                        apollo,\n                        maxDepth,\n                        strictFragments,\n                        keepClientFields,\n                        failOnDeprecated,\n                    });\n                }\n                const project = config.getProject(args.project);\n                const schema = yield project.getSchema();\n                const documents = yield project.getDocuments();\n                return handler({\n                    schema,\n                    documents,\n                    apollo,\n                    maxDepth,\n                    strictFragments,\n                    keepClientFields,\n                    failOnDeprecated,\n                });\n            });\n        },\n    };\n});\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}